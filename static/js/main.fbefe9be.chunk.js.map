{"version":3,"sources":["react-cache/LRU.js","react-cache/ReactCache.js","index.jsx"],"names":["scheduleCallback","Scheduler","IdlePriority","Pending","Resolved","Rejected","identityHashFn","input","lru","limit","LIMIT","first","size","cleanUpIsScheduled","scheduleCleanUp","cleanUp","targetSize","resolvedFirst","last","previous","onDelete","next","deleteLeastRecentlyUsedEntries","add","value","entry","update","newValue","access","setLimit","newLimit","createLRU","entries","Map","accessResult","resource","fetch","key","entriesForResource","get","undefined","set","thenable","then","newResult","status","resolvedResult","error","rejectedResult","newEntry","delete","bind","extend","OrbitControls","objMtlResource","maybeHashInput","hashInput","read","result","preload","createResource","filePath","mtlLoader","MTLLoader","objLoader","OBJLoader","Promise","_ref","Object","asyncToGenerator","regenerator_default","a","mark","_callee","resolve","reject","wrap","_context","prev","load","materials","setMaterials","object","scale","traverse","child","THREE","castShadow","receiveShadow","scene","stop","_x","_x2","apply","this","arguments","ObjMtlModel","_ref2","position","x","y","z","react_default","createElement","Box","attach","args","transparent","opacity","Controls","props","camera","useThree","controls","useRef","useRender","current","assign","ref","App","Fragment","dist","colorManagement","style","background","shadowMap","enabled","type","enableDamping","enablePan","dampingFactor","rotateSpeed","maxPolarAngle","Math","PI","intensity","shadow-mapSize-width","shadow-mapSize-height","shadow-camera-near","shadow-camera-far","react","fallback","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.fbefe9be.chunk.js","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as Scheduler from 'scheduler'\n\n// Intentionally not named imports because Rollup would\n// use dynamic dispatch for CommonJS interop named imports.\nconst { unstable_scheduleCallback: scheduleCallback, unstable_IdlePriority: IdlePriority } = Scheduler\n\ntype Entry<T> = {|\n  value: T,\n  onDelete: () => mixed,\n  previous: Entry<T>,\n  next: Entry<T>\n|}\n\nexport function createLRU<T>(limit: number) {\n  let LIMIT = limit\n\n  // Circular, doubly-linked list\n  let first: Entry<T> | null = null\n  let size: number = 0\n\n  let cleanUpIsScheduled: boolean = false\n\n  function scheduleCleanUp() {\n    if (cleanUpIsScheduled === false && size > LIMIT) {\n      // The cache size exceeds the limit. Schedule a callback to delete the\n      // least recently used entries.\n      cleanUpIsScheduled = true\n      scheduleCallback(IdlePriority, cleanUp)\n    }\n  }\n\n  function cleanUp() {\n    cleanUpIsScheduled = false\n    deleteLeastRecentlyUsedEntries(LIMIT)\n  }\n\n  function deleteLeastRecentlyUsedEntries(targetSize: number) {\n    // Delete entries from the cache, starting from the end of the list.\n    if (first !== null) {\n      const resolvedFirst: Entry<T> = (first: any)\n      let last = resolvedFirst.previous\n      while (size > targetSize && last !== null) {\n        const onDelete = last.onDelete\n        const previous = last.previous\n        last.onDelete = (null: any)\n\n        // Remove from the list\n        last.previous = last.next = (null: any)\n        if (last === first) {\n          // Reached the head of the list.\n          first = last = null\n        } else {\n          ;(first: any).previous = previous\n          previous.next = (first: any)\n          last = previous\n        }\n\n        size -= 1\n\n        // Call the destroy method after removing the entry from the list. If it\n        // throws, the rest of cache will not be deleted, but it will be in a\n        // valid state.\n        onDelete()\n      }\n    }\n  }\n\n  function add(value: T, onDelete: () => mixed): Entry<T> {\n    const entry = {\n      value,\n      onDelete,\n      next: (null: any),\n    previous: (null: any)\n  }\n    if (first === null) {\n      entry.previous = entry.next = entry\n      first = entry\n    } else {\n      // Append to head\n      const last = first.previous\n      last.next = entry\n      entry.previous = last\n\n      first.previous = entry\n      entry.next = first\n\n      first = entry\n    }\n    size += 1\n    return entry\n  }\n\n  function update(entry: Entry<T>, newValue: T): void {\n    entry.value = newValue\n  }\n\n  function access(entry: Entry<T>): T {\n    const next = entry.next\n    if (next !== null) {\n      // Entry already cached\n      const resolvedFirst: Entry<T> = (first: any)\n      if (first !== entry) {\n        // Remove from current position\n        const previous = entry.previous\n        previous.next = next\n        next.previous = previous\n\n        // Append to head\n        const last = resolvedFirst.previous\n        last.next = entry\n        entry.previous = last\n\n        resolvedFirst.previous = entry\n        entry.next = resolvedFirst\n\n        first = entry\n      }\n    } else {\n      // Cannot access a deleted entry\n      // TODO: Error? Warning?\n    }\n    scheduleCleanUp()\n    return entry.value\n  }\n\n  function setLimit(newLimit: number) {\n    LIMIT = newLimit\n    scheduleCleanUp()\n  }\n\n  return {\n    add,\n    update,\n    access,\n    setLimit\n  }\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport { createLRU } from './LRU'\n\ntype Thenable<T> = {\n  then(resolve: (T) => mixed, reject: (mixed) => mixed): mixed\n}\n\ntype Suspender = {\n  then(resolve: () => mixed, reject: () => mixed): mixed\n}\n\ntype PendingResult = {|\n  status: 0,\n  value: Suspender\n|}\n\ntype ResolvedResult<V> = {|\n  status: 1,\n  value: V\n|}\n\ntype RejectedResult = {|\n  status: 2,\n  value: mixed\n|}\n\ntype Result<V> = PendingResult | ResolvedResult<V> | RejectedResult\n\ntype Resource<I, V> = {\n  read(I): V,\n  preload(I): void\n}\n\nconst Pending = 0\nconst Resolved = 1\nconst Rejected = 2\n\nfunction identityHashFn(input) {\n  return input\n}\n\nconst CACHE_LIMIT = 500\nconst lru = createLRU(CACHE_LIMIT)\nconst entries: Map<Resource<any, any>, Map<any, any>> = new Map()\n\nfunction accessResult<I, K, V>(resource: any, fetch: I => Thenable<V>, input: I, key: K): Result<V> {\n  let entriesForResource = entries.get(resource)\n  if (entriesForResource === undefined) {\n    entriesForResource = new Map()\n    entries.set(resource, entriesForResource)\n  }\n  let entry = entriesForResource.get(key)\n  if (entry === undefined) {\n    const thenable = fetch(input)\n    thenable.then(\n      value => {\n        if (newResult.status === Pending) {\n          const resolvedResult: ResolvedResult<V> = (newResult: any)\n          resolvedResult.status = Resolved\n          resolvedResult.value = value\n        }\n      },\n      error => {\n        if (newResult.status === Pending) {\n          const rejectedResult: RejectedResult = (newResult: any)\n          rejectedResult.status = Rejected\n          rejectedResult.value = error\n        }\n      }\n    )\n    const newResult: PendingResult = {\n      status: Pending,\n      value: thenable\n    }\n    const newEntry = lru.add(newResult, deleteEntry.bind(null, resource, key))\n    entriesForResource.set(key, newEntry)\n    return newResult\n  } else {\n    return (lru.access(entry): any)\n  }\n}\n\nfunction deleteEntry(resource, key) {\n  const entriesForResource = entries.get(resource)\n  if (entriesForResource !== undefined) {\n    entriesForResource.delete(key)\n    if (entriesForResource.size === 0) {\n      entries.delete(resource)\n    }\n  }\n}\n\nexport function unstable_createResource<I, K: string | number, V>(fetch: I => Thenable<V>, maybeHashInput?: I => K): Resource<I, V> {\n  const hashInput: I => K = maybeHashInput !== undefined ? maybeHashInput : (identityHashFn: any)\n\nconst resource = {\n  read(input: I): V {\n    // react-cache currently doesn't rely on context, but it may in the\n    // future, so we read anyway to prevent access outside of render.\n    const key = hashInput(input)\n    const result: Result<V> = accessResult(resource, fetch, input, key)\n    switch (result.status) {\n      case Pending: {\n        const suspender = result.value\n        throw suspender\n      }\n      case Resolved: {\n        const value = result.value\n        return value\n      }\n      case Rejected: {\n        const error = result.value\n        throw error\n      }\n      default:\n        // Should be unreachable\n        return (undefined: any)\n    }\n  },\n\n  preload(input: I): void {\n    // react-cache currently doesn't rely on context, but it may in the\n    // future, so we read anyway to prevent access outside of render.\n    const key = hashInput(input)\n    accessResult(resource, fetch, input, key)\n  }\n}\nreturn resource\n}\n\nexport function unstable_setGlobalCacheLimit(limit: number) {\n  lru.setLimit(limit)\n}\n","import ReactDOM from 'react-dom'\nimport * as THREE from 'three';\nimport React, { Suspense, useRef, useState } from 'react'\nimport { unstable_createResource as createResource } from './react-cache/index'\nimport { Canvas, extend, useThree, useRender } from 'react-three-fiber'\nimport { MTLLoader, OBJLoader } from 'three-obj-mtl-loader'\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\nimport './styles.css'\n\n\nextend({ OrbitControls })\n\nconst objMtlResource = createResource(filePath => {\n  const mtlLoader = new MTLLoader();\n  const objLoader = new OBJLoader();\n\n  return new Promise(async (resolve, reject) => {\n    mtlLoader.load(filePath + '.mtl', (materials) => {\n      materials.preload();\n      objLoader.setMaterials(materials);\n      objLoader.load(filePath + '.obj', (object) => {\n        object.scale.set(0.1, 0.1, 0.1);\n        object.traverse(function (child) {\n          if (child instanceof THREE.Mesh) {\n            child.castShadow = true;\n            child.receiveShadow = true;\n          }\n        });\n        resolve({\n          scene: object,\n        })\n      });\n    });\n  });\n});\n\nfunction ObjMtlModel({ filePath, scale, position }) {\n  const { scene } = objMtlResource.read(filePath)\n  scene.scale.set(scale[0], scale[1], scale[2]);\n  scene.position.set(position.x, position.y, position.z);\n  return <primitive object={scene} />\n}\n\nfunction Box() {\n  return (\n    <mesh>\n      <boxBufferGeometry attach=\"geometry\" args={[1, 1, 1]} />\n      <meshStandardMaterial attach=\"material\" transparent opacity={0.5} />\n    </mesh>\n  )\n}\n\nfunction Controls(props) {\n  const { camera } = useThree()\n  const controls = useRef()\n  useRender(() => controls.current && controls.current.update())\n  return <orbitControls ref={controls} args={[camera]} {...props} />\n}\n\nfunction App() {\n  return (\n    <>\n      <Canvas camera={{ position: [15, 9, 18] }} colorManagement style={{ background: '#a3cfff' }} shadowMap={{ enabled: true, type: THREE.PCFShadowMap }}>\n        <Controls enableDamping enablePan={false} dampingFactor={0.1} rotateSpeed={0.1} maxPolarAngle={Math.PI / 2} />\n        <ambientLight intensity={0.5} />\n        <directionalLight\n          position={[10, 10, -10]}\n          shadow-mapSize-width={2048}\n          shadow-mapSize-height={2048}\n          shadow-camera-near={0.01}\n          shadow-camera-far={500}\n          castShadow\n        />\n        <Suspense fallback={<Box />}>\n          <ObjMtlModel filePath='./assets/mushi' scale={[0.3, 0.3, 0.3]} position={{x: 0, y: 0, z: 0}} />\n          <ObjMtlModel filePath='./assets/field-flat' scale={[1, 1, 1]} position={{x: 0, y: -1, z: 0}} />\n        </Suspense>\n      </Canvas>\n    </>\n  )\n}\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}